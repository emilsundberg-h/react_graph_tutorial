{"ast":null,"code":"var graph = require('@microsoft/microsoft-graph-client');\n\nfunction getAuthenticatedClient(accessToken) {\n  // Initialize Graph client\n  const client = graph.Client.init({\n    // Use the provided access token to authenticate\n    // requests\n    authProvider: done => {\n      done(null, accessToken.accessToken);\n    }\n  });\n  return client;\n}\n\nexport async function getEvents(accessToken) {\n  const client = getAuthenticatedClient(accessToken);\n  const events = await client.api('/me/events').select('subject,organizer,start,end').orderby('createdDateTime DESC').get();\n  return events;\n}\nexport async function getUserDetails(accessToken) {\n  const client = getAuthenticatedClient(accessToken);\n  const user = await client.api('/me').get();\n  return user;\n}","map":{"version":3,"sources":["/Users/emilsundberg/graph-tutorial3/src/GraphService.js"],"names":["graph","require","getAuthenticatedClient","accessToken","client","Client","init","authProvider","done","getEvents","events","api","select","orderby","get","getUserDetails","user"],"mappings":"AAAA,IAAIA,KAAK,GAAGC,OAAO,CAAC,mCAAD,CAAnB;;AAEA,SAASC,sBAAT,CAAgCC,WAAhC,EAA6C;AAC3C;AACA,QAAMC,MAAM,GAAGJ,KAAK,CAACK,MAAN,CAAaC,IAAb,CAAkB;AAC/B;AACA;AACAC,IAAAA,YAAY,EAAGC,IAAD,IAAU;AACtBA,MAAAA,IAAI,CAAC,IAAD,EAAOL,WAAW,CAACA,WAAnB,CAAJ;AACD;AAL8B,GAAlB,CAAf;AAQA,SAAOC,MAAP;AACD;;AACD,OAAO,eAAeK,SAAf,CAAyBN,WAAzB,EAAsC;AACzC,QAAMC,MAAM,GAAGF,sBAAsB,CAACC,WAAD,CAArC;AAEA,QAAMO,MAAM,GAAG,MAAMN,MAAM,CACxBO,GADkB,CACd,YADc,EAElBC,MAFkB,CAEX,6BAFW,EAGlBC,OAHkB,CAGV,sBAHU,EAIlBC,GAJkB,EAArB;AAMA,SAAOJ,MAAP;AACD;AAEH,OAAO,eAAeK,cAAf,CAA8BZ,WAA9B,EAA2C;AAChD,QAAMC,MAAM,GAAGF,sBAAsB,CAACC,WAAD,CAArC;AAEA,QAAMa,IAAI,GAAG,MAAMZ,MAAM,CAACO,GAAP,CAAW,KAAX,EAAkBG,GAAlB,EAAnB;AACA,SAAOE,IAAP;AACD","sourcesContent":["var graph = require('@microsoft/microsoft-graph-client');\n\nfunction getAuthenticatedClient(accessToken) {\n  // Initialize Graph client\n  const client = graph.Client.init({\n    // Use the provided access token to authenticate\n    // requests\n    authProvider: (done) => {\n      done(null, accessToken.accessToken);\n    }\n  });\n\n  return client;\n}\nexport async function getEvents(accessToken) {\n    const client = getAuthenticatedClient(accessToken);\n  \n    const events = await client\n      .api('/me/events')\n      .select('subject,organizer,start,end')\n      .orderby('createdDateTime DESC')\n      .get();\n  \n    return events;\n  }\n\nexport async function getUserDetails(accessToken) {\n  const client = getAuthenticatedClient(accessToken);\n\n  const user = await client.api('/me').get();\n  return user;\n}\n"]},"metadata":{},"sourceType":"module"}