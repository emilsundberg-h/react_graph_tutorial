{"ast":null,"code":"var _jsxFileName = \"/Users/emilsundberg/graph-tutorial3/src/App.js\";\nimport React, { Component } from 'react';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\nimport { Container } from 'reactstrap';\nimport NavBar from './NavBar';\nimport ErrorMessage from './ErrorMessage';\nimport Welcome from './Welcome';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport config from './Config';\nimport { UserAgentApplication } from 'msal';\nimport { getUserDetails } from './GraphService';\nimport Calendar from './Calendar';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.userAgentApplication = new UserAgentApplication({\n      auth: {\n        clientId: config.appId,\n        redirectUri: config.redirectUri\n      },\n      cache: {\n        cacheLocation: \"localStorage\",\n        storeAuthStateInCookie: true\n      }\n    });\n    var user = this.userAgentApplication.getAccount();\n    this.state = {\n      isAuthenticated: user !== null,\n      user: {},\n      error: null\n    };\n\n    if (user) {\n      // Enhance user object with data from Graph\n      this.getUserProfile();\n    }\n  }\n\n  async login() {\n    try {\n      await this.userAgentApplication.loginPopup({\n        scopes: config.scopes,\n        prompt: \"select_account\"\n      });\n      await this.getUserProfile();\n    } catch (err) {\n      var error = {};\n\n      if (typeof err === 'string') {\n        var errParts = err.split('|');\n        error = errParts.length > 1 ? {\n          message: errParts[1],\n          debug: errParts[0]\n        } : {\n          message: err\n        };\n      } else {\n        error = {\n          message: err.message,\n          debug: JSON.stringify(err)\n        };\n      }\n\n      this.setState({\n        isAuthenticated: false,\n        user: {},\n        error: error\n      });\n    }\n  }\n\n  logout() {\n    this.userAgentApplication.logout();\n  }\n\n  async getUserProfile() {\n    try {\n      // Get the access token silently\n      // If the cache contains a non-expired token, this function\n      // will just return the cached token. Otherwise, it will\n      // make a request to the Azure OAuth endpoint to get a token\n      var accessToken = await this.userAgentApplication.acquireTokenSilent({\n        scopes: config.scopes\n      });\n\n      if (accessToken) {\n        // Get the user's profile from Graph\n        var user = await getUserDetails(accessToken);\n        this.setState({\n          isAuthenticated: true,\n          user: {\n            displayName: user.displayName,\n            email: user.mail || user.userPrincipalName\n          },\n          error: null\n        });\n      }\n    } catch (err) {\n      var error = {};\n\n      if (typeof err === 'string') {\n        var errParts = err.split('|');\n        error = errParts.length > 1 ? {\n          message: errParts[1],\n          debug: errParts[0]\n        } : {\n          message: err\n        };\n      } else {\n        error = {\n          message: err.message,\n          debug: JSON.stringify(err)\n        };\n      }\n\n      this.setState({\n        isAuthenticated: false,\n        user: {},\n        error: error\n      });\n    }\n  }\n\n  render() {\n    let error = null;\n\n    if (this.state.error) {\n      error = /*#__PURE__*/React.createElement(ErrorMessage, {\n        message: this.state.error.message,\n        debug: this.state.error.debug,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 15\n        }\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(Router, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(NavBar, {\n      isAuthenticated: this.state.isAuthenticated,\n      authButtonMethod: this.state.isAuthenticated ? this.logout.bind(this) : this.login.bind(this),\n      user: this.state.user,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Container, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 11\n      }\n    }, error, /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/calender\",\n      render: props => /*#__PURE__*/React.createElement(Welcome, Object.assign({}, props, {\n        isAuthenticated: this.state.isAuthenticated,\n        user: this.state.user,\n        authButtonMethod: this.login.bind(this),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 17\n        }\n      })),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 13\n      }\n    }))));\n  }\n\n  setErrorMessage(message, debug) {\n    this.setState({\n      error: {\n        message: message,\n        debug: debug\n      }\n    });\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/emilsundberg/graph-tutorial3/src/App.js"],"names":["React","Component","BrowserRouter","Router","Route","Container","NavBar","ErrorMessage","Welcome","config","UserAgentApplication","getUserDetails","Calendar","App","constructor","props","userAgentApplication","auth","clientId","appId","redirectUri","cache","cacheLocation","storeAuthStateInCookie","user","getAccount","state","isAuthenticated","error","getUserProfile","login","loginPopup","scopes","prompt","err","errParts","split","length","message","debug","JSON","stringify","setState","logout","accessToken","acquireTokenSilent","displayName","email","mail","userPrincipalName","render","bind","setErrorMessage"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\nimport { Container } from 'reactstrap';\nimport NavBar from './NavBar';\nimport ErrorMessage from './ErrorMessage';\nimport Welcome from './Welcome';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport config from './Config';\nimport { UserAgentApplication } from 'msal';\nimport { getUserDetails } from './GraphService';\nimport Calendar from './Calendar';\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props);\n  \n    this.userAgentApplication = new UserAgentApplication({\n          auth: {\n              clientId: config.appId,\n              redirectUri: config.redirectUri\n          },\n          cache: {\n              cacheLocation: \"localStorage\",\n              storeAuthStateInCookie: true\n          }\n      });\n  \n    var user = this.userAgentApplication.getAccount();\n  \n    this.state = {\n      isAuthenticated: (user !== null),\n      user: {},\n      error: null\n    };\n  \n    if (user) {\n      // Enhance user object with data from Graph\n      this.getUserProfile();\n    }\n    \n  }\n  async login() {\n    try {\n      await this.userAgentApplication.loginPopup(\n          {\n            scopes: config.scopes,\n            prompt: \"select_account\"\n        });\n      await this.getUserProfile();\n    }\n    catch(err) {\n      \n      var error = {};\n  \n      if (typeof(err) === 'string') {\n        var errParts = err.split('|');\n        error = errParts.length > 1 ?\n          { message: errParts[1], debug: errParts[0] } :\n          { message: err };\n      } else {\n        error = {\n          message: err.message,\n          debug: JSON.stringify(err)\n        };\n      }\n  \n      this.setState({\n        isAuthenticated: false,\n        user: {},\n        error: error\n      });\n    }\n  }\n  logout() {\n    this.userAgentApplication.logout();\n  }\n  async getUserProfile() {\n    try {\n      // Get the access token silently\n      // If the cache contains a non-expired token, this function\n      // will just return the cached token. Otherwise, it will\n      // make a request to the Azure OAuth endpoint to get a token\n  \n      var accessToken = await this.userAgentApplication.acquireTokenSilent({\n        scopes: config.scopes\n      });\n  \n      if (accessToken) {\n        // Get the user's profile from Graph\n        var user = await getUserDetails(accessToken);\n        this.setState({\n          isAuthenticated: true,\n          user: {\n            displayName: user.displayName,\n            email: user.mail || user.userPrincipalName\n          },\n          error: null\n        });\n      }\n    }\n    catch(err) {\n      var error = {};\n      if (typeof(err) === 'string') {\n        var errParts = err.split('|');\n        error = errParts.length > 1 ?\n          { message: errParts[1], debug: errParts[0] } :\n          { message: err };\n      } else {\n        error = {\n          message: err.message,\n          debug: JSON.stringify(err)\n        };\n      }\n  \n      this.setState({\n        isAuthenticated: false,\n        user: {},\n        error: error\n      });\n    }\n  }\n\n  render() {\n    let error = null;\n    if (this.state.error) {\n      error = <ErrorMessage message={this.state.error.message} debug={this.state.error.debug} />;\n    }\n\n    return (\n      <Router>\n        <div>\n        <NavBar\n  isAuthenticated={this.state.isAuthenticated}\n  authButtonMethod={this.state.isAuthenticated ? this.logout.bind(this) : this.login.bind(this)}\n  user={this.state.user}/>\n          <Container>\n            {error}\n            <Route exact path=\"/calender\"\n              render={(props) =>\n                <Welcome {...props}\n                isAuthenticated={this.state.isAuthenticated}\n                user={this.state.user}\n                authButtonMethod={this.login.bind(this)} />\n              } />\n          </Container>\n        </div>\n      </Router>\n    );\n  }\n\n  setErrorMessage(message, debug) {\n    this.setState({\n      error: {message: message, debug: debug}\n    });\n  }\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}